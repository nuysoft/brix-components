define("components/ellipsis",["jquery","underscore","brix/base"],function(t,e,i){return function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){var n,s;n=[i(1),i(2),i(3)],s=function(t,e,i){var n="ellip",s="ellip-line";return i.extend({options:{lines:"auto"},init:function(){"auto"!==this.options.lines&&(this.options.lines=+this.options.lines),this.$element=t(this.element),this._text=this.$element.text(),this._height=this.$element.height(),this.$relatedElement=t('<span class="'+n+'" />').text(this._text),this.$element.empty().append(this.$relatedElement)},render:function(){if(1===this.options.lines)return void this.$relatedElement.addClass(s);if(!("auto"===this.options.lines&&this.$relatedElement.prop("scrollHeight")<=this._height)){var e=this.parseWords(this._text),i=this.parseStart(this.options.lines,e);this.update(e,i);var n=this,r="click.ellipsis_"+this.options.clientId;t(window).off(r).on(r,function(){n.render()})}},update:function(t,e){t[e]='<span class="'+s+'">'+t[e],t.push("</span>"),this.$relatedElement.html(t.join(""))},parseStart:function(t,i){var n=e.map(i,function(t){return"<span>"+t+"</span>"});return this.$relatedElement.html(n.join("")),n=this.$relatedElement.find("span"),"auto"===t?this.parseStartByHeight(n):this.parseStartByLines(n)},parseStartByLines:function(e){for(var i,n,s,r=0,o=0;o<e.length;o++)if(n=t(e[o]).position().top,n!==s&&(s=n,r+=1),r===this.options.lines){i=o;break}return i},parseStartByHeight:function(e){for(var i,n,s,r,o=0,a={},h=0;h<e.length;h++)if(n=t(e[h]).position().top,s=s||t(e[h]).height(),n!==r?(r=n,o+=1,a[o]=[e[h]]):a[o].push([e[h]]),n+s>this._height){i=h-a[o-1].length;break}return i},parseWords:function(e){return t.trim(e).split("")},resize:function(){var t=this;clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(function(){t.render()},100)}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(e,i){e.exports=t},function(t,i){t.exports=e},function(t,e){t.exports=i}])});