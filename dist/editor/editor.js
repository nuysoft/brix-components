define("components/editor",["jquery","underscore","mousetrap","brix/base"],function(t,n,e,a){return function(t){function n(a){if(e[a])return e[a].exports;var i=e[a]={exports:{},id:a,loaded:!1};return t[a].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([function(t,n,e){var a,i;a=[e(1),e(2),e(3),e(4),e(5)],i=function(t,n,e,a,i){function l(){}function d(t,n){var e=new FileReader;e.onload=function(t){n&&n(t.target.result)},e.onerror=e.onprogress=function(){console.log(arguments)},e.readAsDataURL(t)}function r(e){e=t(".toolbar"),n.each(e.find("[data-command]"),function(n){var e=t(n),a=e.data("command");document.queryCommandState(a)?e.addClass("btn-primary"):e.removeClass("btn-primary")})}function o(t,n){var e=t.split(" "),a=e.shift(),i=e.join(" ")+(n||"");document.execCommand(a,0,i),r()}function s(a){n.each(g,function(n,i){e.bind(i.split(" "),function(e){e.target===a&&(e=new t.Event(e),e.preventDefault(),e.stopPropagation(),o(n))})})}function c(){var t=window.getSelection();if(t.getRangeAt&&t.rangeCount)return t.getRangeAt(0)}function u(){p=c()}function f(){var t=window.getSelection();if(p){try{t.removeAllRanges()}catch(n){document.body.createTextRange().select(),document.selection.empty()}t.addRange(p)}}function m(e){var a=t(".editor");a.focus(),n.each(e,function(t){/^image\//.test(t.type)?d(t,function(t){o("insertimage",t)}):console.log("unsupported file type",t.type)})}function b(e,a){e=t(".editor"),a=t(".toolbar"),n.each(a.find("[data-command]"),function(n){t(n).on("click",function(){f(),e.focus(),o(t(this).data("command")),u()})})}function v(){var n=t(".editor");n.on("dragenter dragover",!1).on("drop",function(t){var n=t.originalEvent.dataTransfer;t.stopPropagation(),t.preventDefault(),n&&n.files&&n.files.length>0&&m(n.files)})}n.extend(l.prototype,a.prototype,{options:{},render:function(){this.data=this.data||n.extend({},this.options);var e=this.$element=t(this.element),a=n.template(i)(this.data);e.append(a);var l=this.$toolbar=e.find(".btn-toolbar"),d=this.$editor=e.find(".editor");return s(d[0]),b(d[0]),v(),d.attr("contenteditable",!0).on("mouseup keyup mouseout",function(){u(),r(l)}),this},clean:function(){var t=this.$editor.html(),n=/(<br>|\s|<div><br><\/div>|&nbsp;)*$/;return this.$editor.html(t&&t.replace(n,"")),this}});var p,g={"ctrl+b meta+b":"bold","ctrl+i meta+i":"italic","ctrl+u meta+u":"underline","ctrl+z meta+z":"undo","ctrl+y meta+y meta+shift+z":"redo","ctrl+l meta+l":"justifyleft","ctrl+r meta+r":"justifyright","ctrl+e meta+e":"justifycenter","ctrl+j meta+j":"justifyfull","shift+tab":"outdent",tab:"indent"};return l}.apply(n,a),!(void 0!==i&&(t.exports=i))},function(n,e){n.exports=t},function(t,e){t.exports=n},function(t,n){t.exports=e},function(t,n){t.exports=a},function(t,n,e){var a;a=function(){return'<div class="editor-wrapper">\n    <div class="toolbar">\n        <div class="btn-group">\n            <a class="btn btn-default" data-command="bold"          title="Bold (Ctrl/Cmd+B)">      <i class="fa fa-bold"></i>          </a>\n            <a class="btn btn-default" data-command="italic"        title="Italic (Ctrl/Cmd+I)">    <i class="fa fa-italic"></i>        </a>\n            <a class="btn btn-default" data-command="strikethrough" title="Strikethrough">          <i class="fa fa-strikethrough"></i> </a>\n            <a class="btn btn-default" data-command="underline"     title="Underline (Ctrl/Cmd+U)"> <i class="fa fa-underline"></i>     </a>\n        </div>\n        <div class="btn-group">\n            <a class="btn btn-default" data-command="insertunorderedlist" title="Bullet list">               <i class="fa fa-list-ul"></i> </a>\n            <a class="btn btn-default" data-command="insertorderedlist"   title="Number list">               <i class="fa fa-list-ol"></i> </a>\n            <a class="btn btn-default" data-command="outdent"             title="Reduce indent (Shift+Tab)"> <i class="fa fa-dedent"></i>  </a>\n            <a class="btn btn-default" data-command="indent"              title="Indent (Tab)">              <i class="fa fa-indent"></i>  </a>\n        </div>\n        <div class="btn-group">\n            <a class="btn btn-default" data-command="justifyleft"   title="Align Left (Ctrl/Cmd+L)">  <i class="fa fa-align-left"></i>    </a>\n            <a class="btn btn-default" data-command="justifycenter" title="Center (Ctrl/Cmd+E)">      <i class="fa fa-align-center"></i>  </a>\n            <a class="btn btn-default" data-command="justifyright"  title="Align Right (Ctrl/Cmd+R)"> <i class="fa fa-align-right"></i>   </a>\n            <a class="btn btn-default" data-command="justifyfull"   title="Justify (Ctrl/Cmd+J)">     <i class="fa fa-align-justify"></i> </a>\n        </div>\n    </div>\n    <div class="editor mousetrap" contenteditable="true">\n        <div><b>Bold (Ctrl/Cmd+B)</b></div><div><i>Italic (Ctrl/Cmd+I)</i></div><div><strike>Strikethrough</strike></div><div><u>Underline (Ctrl/Cmd+U)</u></div><div><ul><li><span style="line-height: 1.42857143;">Bullet list</span><br></li></ul></div><div><ol><li><span style="line-height: 1.42857143;">Number list</span><br></li></ol></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>Reduce indent (Shift+Tab)</div></blockquote><div>Indent (Tab)</div><div>Align Left (Ctrl/Cmd+L)</div><div style="text-align: center;">Center (Ctrl/Cmd+E)</div><div style="text-align: right;">Align Right (Ctrl/Cmd+R)</div><div style="text-align: justify;">Justify (Ctrl/Cmd+J)</div>\n    </div>\n</div>'}.call(n,e,n,t),!(void 0!==a&&(t.exports=a))}])});